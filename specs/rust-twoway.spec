# Generated by rust2rpm 24
# * missing and outdated dev-dependencies
%bcond_with check
%global debug_package %{nil}

%global crate twoway

Name:           rust-twoway
Version:        0.2.2
Release:        %autorelease
Summary:        Fast substring search for strings and byte strings

# Upstream license specification: MIT/Apache-2.0
License:        MIT OR Apache-2.0
URL:            https://crates.io/crates/twoway
Source:         %{crates_source}
# Manually created patch for downstream crate metadata changes
# * drop optional features with broken dependencies
Patch:          twoway-fix-metadata.diff

BuildRequires:  rust-packaging >= 21

%global _description %{expand:
Fast substring search for strings and byte strings. Optional SSE4.2
acceleration (if detected at runtime) using pcmpestri. Memchr is the
only mandatory dependency. The two way algorithm is also used by rust's
libstd itself, but here it is exposed both for byte strings, using
memchr, and optionally using a SSE4.2 accelerated version.}

%description %{_description}

%package        devel
Summary:        %{summary}
BuildArch:      noarch
Provides:       deprecated()

%description    devel %{_description}

This package contains library source intended for building other packages which
use the "%{crate}" crate.

%files          devel
%license %{crate_instdir}/LICENSE-APACHE
%license %{crate_instdir}/LICENSE-MIT
%doc %{crate_instdir}/README.rst
%{crate_instdir}/

%package     -n %{name}+default-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+default-devel %{_description}

This package contains library source intended for building other packages which
use the "default" feature of the "%{crate}" crate.

%files       -n %{name}+default-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+pattern-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+pattern-devel %{_description}

This package contains library source intended for building other packages which
use the "pattern" feature of the "%{crate}" crate.

%files       -n %{name}+pattern-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+use_std-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+use_std-devel %{_description}

This package contains library source intended for building other packages which
use the "use_std" feature of the "%{crate}" crate.

%files       -n %{name}+use_std-devel
%ghost %{crate_instdir}/Cargo.toml

%prep
%autosetup -n %{crate}-%{version_no_tilde} -p1
%cargo_prep

%generate_buildrequires
%cargo_generate_buildrequires

%build
%cargo_build

%install
%cargo_install

%if %{with check}
%check
%cargo_test
%endif

%changelog
%autochangelog
