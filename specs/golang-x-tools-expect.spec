# Generated by go2rpm
%bcond check 1

%global debug_package %{nil}

# https://github.com/golang/tools
%global goipath         golang.org/x/tools/go/expect
%global forgeurl        https://github.com/golang/tools
Version:                0.1.1
%global tag             go/expect/v%{version}-deprecated
%{lua: rpm.define("safe_tag " .. string.gsub(rpm.expand("%tag"), "/", "-"))}
%global distprefix      %{nil}

%gometa -L -f


%global common_description %{expand:
Package expect provides support for interpreting structured comments in Go
source code (including go.mod and go.work files) as test expectations.}

%global golicenses      LICENSE PATENTS
%global godocs          CONTRIBUTING.md

%global godevelheader %{expand:
# Upstream specifically split this subpackage out of golang.org/x/tools for
# backwards-compatibility with things that need it, but specified that it is
# deprecated.
Provides: deprecated()
}

Name:           golang-x-tools-expect
Release:        %autorelease
Summary:        Test expectations from structured comments in Go code

License:        BSD-3-Clause
URL:            %{gourl}
Source:         %{gosource}

%description %{common_description}

%gopkg

%prep
%goprep -A
%autopatch -q -p1
# Created by goprep, but with the wrong path, so re-create it.
rm -r _build/src/golang.org/x/tools
ln -s %{_builddir}/tools-%{safe_tag} _build/src/golang.org/x/tools
# Delete everything not related to the subpackage to reduce BuildRequires.
rm -r benchmark blog cmd container copyright cover godoc gopls imports internal
rm -r playground present refactor txtar
rm codereview.cfg go.mod go.sum README.md
rm -r go/analysis go/ast go/buildutil go/callgraph go/cfg go/gccgoexportdata
rm -r go/gcexportdata go/internal go/loader go/packages go/ssa go/types

%generate_buildrequires
%go_generate_buildrequires

%install
%gopkginstall

%if %{with check}
%check
%gocheck
%endif

%gopkgfiles

%changelog
%autochangelog
