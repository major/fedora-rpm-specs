# Generated by rust2rpm 28
%bcond check 1

%global crate av-scenechange

Name:           rust-av-scenechange
Version:        0.14.1
Release:        %autorelease
Summary:        Estimates frames in a video where a scenecut would be ideal

License:        MIT AND BSD-2-Clause AND ISC AND LicenseRef-BSD-2-Clause-WITH-AdditionRef-AOMPL-1.0
URL:            https://crates.io/crates/av-scenechange
Source:         %{crates_source}
# Manually created patch for downstream crate metadata changes
# * Adjust SPDX expression from “MIT” to “MIT AND BSD-2-Clause AND ISC AND
#   LicenseRef-BSD-2-Clause-WITH-AdditionRef-AOMPL-1.0”. The adjustment to “MIT
#   AND BSD-2-Clause AND ISC” was suggested upstream in “Better handle licenses
#   attached to assembly routines,”
#   https://github.com/rust-av/av-scenechange/pull/201, and the
#   “LicenseRef-BSD-2-Clause-WITH-AdditionRef-AOMPL-1.0” part is downstream-only
#   since SPDX handling of the Alliance for Open Media Patent License 1.0 is not
#   yet standardized; see
#   https://gitlab.com/fedora/legal/fedora-license-data/-/issues/407.
# * Update pastey from 0.1 to 0.2. Downstream-only because the pastey dependency
#   was removed entirely in 0.15.0.
# * Update console from 0.15 to 0.16:
#   https://github.com/rust-av/av-scenechange/commit/3868441d01472d30531598fef77e5a1cba2ef0e0
Patch:          av-scenechange-fix-metadata.diff
# * Add license texts for various assembly routines to LICENSE
# * From “Better handle licenses attached to assembly routines”:
#   https://github.com/rust-av/av-scenechange/pull/201
Patch10:        https://github.com/rust-av/av-scenechange/pull/201/commits/b12eccf8998e189ee1568fcf8bf6fc916dcb818d.patch

BuildRequires:  cargo-rpm-macros >= 24
BuildRequires:  help2man

%global _description %{expand:
Estimates frames in a video where a scenecut would be ideal.}

%description %{_description}

%package     -n %{crate}
Summary:        %{summary}
# Apache-2.0 OR BSL-1.0
# Apache-2.0 OR MIT
# BSD-2-Clause
# MIT
# MIT AND BSD-2-Clause AND ISC AND LicenseRef-BSD-2-Clause-WITH-AdditionRef-AOMPL-1.0
# MIT OR Apache-2.0
# Unlicense OR MIT
License:        %{shrink:
    MIT AND
    BSD-2-Clause AND
    ISC AND
    LicenseRef-BSD-2-Clause-WITH-AdditionRef-AOMPL-1.0 AND
    (Apache-2.0 OR BSL-1.0) AND
    (Apache-2.0 OR MIT) AND
    (Unlicense OR MIT)
    }
# LICENSE.dependencies contains a full license breakdown

%description -n %{crate} %{_description}

%files       -n %{crate}
%license LICENSE
%license LICENSE.dependencies
%doc CHANGELOG.md
%doc README.md
%{_bindir}/av-scenechange
%{_mandir}/man1/av-scenechange.1*

%package        devel
Summary:        %{summary}
BuildArch:      noarch

%description    devel %{_description}

This package contains library source intended for building other packages which
use the "%{crate}" crate.

%files          devel
%license %{crate_instdir}/LICENSE
%doc %{crate_instdir}/CHANGELOG.md
%doc %{crate_instdir}/README.md
%{crate_instdir}/

%package     -n %{name}+default-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+default-devel %{_description}

This package contains library source intended for building other packages which
use the "default" feature of the "%{crate}" crate.

%files       -n %{name}+default-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+asm-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+asm-devel %{_description}

This package contains library source intended for building other packages which
use the "asm" feature of the "%{crate}" crate.

%files       -n %{name}+asm-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+binary-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+binary-devel %{_description}

This package contains library source intended for building other packages which
use the "binary" feature of the "%{crate}" crate.

%files       -n %{name}+binary-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+cc-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+cc-devel %{_description}

This package contains library source intended for building other packages which
use the "cc" feature of the "%{crate}" crate.

%files       -n %{name}+cc-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+clap-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+clap-devel %{_description}

This package contains library source intended for building other packages which
use the "clap" feature of the "%{crate}" crate.

%files       -n %{name}+clap-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+console-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+console-devel %{_description}

This package contains library source intended for building other packages which
use the "console" feature of the "%{crate}" crate.

%files       -n %{name}+console-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+devel-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+devel-devel %{_description}

This package contains library source intended for building other packages which
use the "devel" feature of the "%{crate}" crate.

%files       -n %{name}+devel-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+fern-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+fern-devel %{_description}

This package contains library source intended for building other packages which
use the "fern" feature of the "%{crate}" crate.

%files       -n %{name}+fern-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+libc-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+libc-devel %{_description}

This package contains library source intended for building other packages which
use the "libc" feature of the "%{crate}" crate.

%files       -n %{name}+libc-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+nasm-rs-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+nasm-rs-devel %{_description}

This package contains library source intended for building other packages which
use the "nasm-rs" feature of the "%{crate}" crate.

%files       -n %{name}+nasm-rs-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+serde-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+serde-devel %{_description}

This package contains library source intended for building other packages which
use the "serde" feature of the "%{crate}" crate.

%files       -n %{name}+serde-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+serde_json-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+serde_json-devel %{_description}

This package contains library source intended for building other packages which
use the "serde_json" feature of the "%{crate}" crate.

%files       -n %{name}+serde_json-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+serialize-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+serialize-devel %{_description}

This package contains library source intended for building other packages which
use the "serialize" feature of the "%{crate}" crate.

%files       -n %{name}+serialize-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+tracing-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+tracing-devel %{_description}

This package contains library source intended for building other packages which
use the "tracing" feature of the "%{crate}" crate.

%files       -n %{name}+tracing-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+tracing-chrome-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+tracing-chrome-devel %{_description}

This package contains library source intended for building other packages which
use the "tracing-chrome" feature of the "%{crate}" crate.

%files       -n %{name}+tracing-chrome-devel
%ghost %{crate_instdir}/Cargo.toml

%package     -n %{name}+tracing-subscriber-devel
Summary:        %{summary}
BuildArch:      noarch

%description -n %{name}+tracing-subscriber-devel %{_description}

This package contains library source intended for building other packages which
use the "tracing-subscriber" feature of the "%{crate}" crate.

%files       -n %{name}+tracing-subscriber-devel
%ghost %{crate_instdir}/Cargo.toml

%prep
%autosetup -n %{crate}-%{version} -p1
%cargo_prep

%generate_buildrequires
%cargo_generate_buildrequires

%build
%cargo_build
%{cargo_license_summary}
%{cargo_license} > LICENSE.dependencies
help2man --no-info --version-string='%{version}' --output=av-scenechange.1 \
    target/rpm/av-scenechange

%install
%cargo_install
install -t %{buildroot}%{_mandir}/man1 -D -p -m 0644 av-scenechange.1

%if %{with check}
%check
%cargo_test
%endif

%changelog
%autochangelog
