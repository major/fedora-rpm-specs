%global image_version 42
%global image_release 1.1
# These are published to the mirror network as well, but we use koji as that
# makes it easier to fetch the corresponding metadata files
%global baseurl https://kojipkgs.fedoraproject.org/packages/Fedora-FEX-RootFS/%{image_version}/%{image_release}/images

Name:           fex-emu-rootfs-fedora
Version:        %{image_version}^%{image_release}
Release:        %autorelease
Summary:        Fedora-based RootFS for the FEX emulator

# Generated from the Kiwi packages list with
#  gen-license-tag.py Fedora-FEX-RootFS-*.x86_64.packages
License:        (( GPL-1.0-or-later OR Artistic-1.0-Perl ) AND BSD-3-Clause) AND ((AFL-2.1 OR GPL-2.0-or-later) AND GPL-2.0-or-later) AND ((FTL OR GPL-2.0-or-later) AND BSD-3-Clause AND MIT AND MIT-Modern-Variant AND LicenseRef-Fedora-Public-Domain AND Zlib) AND ((GPL-1.0-or-later OR Artistic-1.0-Perl) AND Artistic-2.0) AND ((GPL-1.0-or-later OR Artistic-1.0-Perl) AND FSFAP) AND ((GPL-1.0-or-later OR Artistic-1.0-Perl) AND MPL-2.0) AND ((GPL-1.0-or-later OR Artistic-1.0-Perl) AND Martin-Birgmeier AND Spencer-86 AND MIT AND Unicode-3.0 AND LicenseRef-Fedora-Public-Domain) AND ((GPL-1.0-or-later OR Artistic-1.0-Perl) AND metamail) AND ((GPL-2.0-or-later OR LGPL-3.0-or-later) AND GPL-3.0-or-later) AND ((LGPL-3.0-or-later OR GPL-2.0-or-later OR (LGPL-3.0-or-later AND GPL-2.0-or-later)) AND GFDL-1.3-invariants-or-later) AND (0BSD AND GPL-2.0-or-later AND LicenseRef-Fedora-Public-Domain) AND (Apache-2.0 AND GPL-3.0-or-later AND MIT) AND (Apache-2.0 AND LGPL-2.0-or-later AND LGPL-2.1-or-later AND (Apache-2.0 OR LGPL-2.1-or-later)) AND (Apache-2.0 AND LicenseRef-scancode-google-patent-license-webm AND BSD-3-Clause AND FSFULLRWD) AND (Apache-2.0 WITH LLVM-exception AND BSD-3-Clause AND Zlib AND BSD-2-Clause) AND (Apache-2.0 WITH LLVM-exception OR NCSA OR MIT) AND (Apache-2.0 WITH LLVM-exception OR NCSA) AND (BSD-2-Clause AND BSD-3-Clause) AND (BSD-2-Clause AND FSFULLR AND GPL-2.0-or-later WITH Libtool-exception AND BSD-3-Clause AND FSFUL) AND (BSD-2-Clause AND ISC AND MIT AND (Apache-2.0 OR MIT) AND (Apache-2.0 WITH LLVM-exception OR Apache-2.0 OR MIT) AND (Unlicense OR MIT)) AND (BSD-2-Clause AND ISC) AND (BSD-2-Clause AND MIT) AND (BSD-2-Clause-Darwin AND BSD-2-Clause) AND (BSD-3-Clause AND Apache-2.0 AND Zlib) AND (BSD-3-Clause AND BSD-2-Clause AND GPL-3.0-or-later) AND (BSD-3-Clause AND BSD-2-Clause AND ISC) AND (BSD-3-Clause AND BSD-2-Clause) AND (BSD-3-Clause AND FSFULLR AND X11 AND GPL-2.0-or-later AND FSFAP AND FSFUL AND GPL-3.0-or-later) AND (BSD-3-Clause AND GPL-2.0-only) AND (BSD-3-Clause AND GPL-2.0-or-later AND GFDL-1.1-or-later) AND (BSD-3-Clause AND GPL-2.0-or-later) AND (BSD-3-Clause AND ISC AND LicenseRef-Fedora-Public-Domain) AND (BSD-3-Clause AND LGPL-2.1-or-later) AND (BSD-3-Clause AND MIT AND LicenseRef-Fedora-Public-Domain) AND (BSD-3-Clause AND MIT-open-group AND Zlib AND Apache-2.0) AND (BSD-3-Clause OR GPL-2.0-only) AND (BSD-3-Clause OR GPL-2.0-or-later) AND (BSD-3-clause AND TU-Berlin-1.0) AND (Brian-Gladman-2-Clause AND BSD-2-Clause AND (BSD-2-Clause OR GPL-2.0-or-later) AND BSD-2-Clause-first-lines AND BSD-3-Clause AND BSD-4-Clause AND CMU-Mach-nodoc AND FSFULLRWD AND HPND AND HPND-export2-US AND HPND-export-US AND HPND-export-US-acknowledgement AND HPND-export-US-modify AND ISC AND MIT AND MIT-CMU AND OLDAP-2.8 AND OpenVision) AND (CC0-1.0 OR Apache-1.0 OR Apache-2.0) AND (GPL-1.0-or-later AND GPL-2.0-or-later AND GPL-3.0-or-later WITH Autoconf-exception-generic AND Boehm-GC) AND (GPL-1.0-or-later OR Artistic-1.0-Perl) AND (GPL-2.0-only AND GPL-2.0-or-later AND BSD-2-Clause AND BSD-3-Clause AND BSD-4-Clause-UC AND LicenseRef-Fedora-Public-Domain) AND (GPL-2.0-only AND GPL-2.0-or-later AND LGPL-2.0-only AND LGPL-2.0-or-later AND LGPL-2.1-or-later AND LGPL-3.0-or-later AND BSD-3-Clause AND IJG-short AND (MIT OR Unlicense)) AND (GPL-2.0-only OR BSD-2-Clause AND BSD-3-Clause) AND (GPL-2.0-or-later AND BSD-2-Clause) AND (GPL-2.0-or-later AND GPL-3.0-or-later AND FSFUL AND FSFULLRWD AND LGPL-2.1-only AND LGPL-2.1-or-later AND X11) AND (GPL-2.0-or-later AND LGPL-2.0-or-later AND LGPL-2.1-or-later AND BSD-2-Clause) AND (GPL-2.0-or-later AND LGPL-2.1-only AND MIT AND BSD-4-Clause-UC AND MS-PL AND MPL-1.1) AND (GPL-2.0-or-later AND LGPL-2.1-or-later) AND (GPL-2.0-or-later AND MIT) AND (GPL-2.0-or-later OR Artistic-1.0-Perl) AND (GPL-2.0-or-later OR LGPL-2.1-or-later) AND (GPL-2.0-or-later OR LGPL-3.0-or-later) AND (GPL-2.0-or-later WITH Autoconf-exception-generic) AND (GPL-2.0-or-later WITH SANE-exception AND GPL-2.0-or-later AND GPL-2.0-only AND LGPL-2.0-or-later AND LGPL-2.1-or-later AND LicenseRef-Fedora-Public-Domain AND IJG AND MIT) AND (GPL-3.0-or-later AND (GPL-3.0-or-later WITH Bison-exception-2.2) AND (LGPL-2.0-or-later WITH GCC-exception-2.0) AND BSD-3-Clause AND GFDL-1.3-or-later AND GPL-2.0-or-later AND LGPL-2.1-or-later AND LGPL-2.0-or-later) AND (GPL-3.0-or-later AND (GPL-3.0-or-later WITH GCC-exception-3.1) AND GPL-2.0-or-later AND (GPL-2.0-or-later WITH GCC-exception-2.0) AND LGPL-2.0-or-later) AND (GPL-3.0-or-later AND GFDL-1.3-no-invariants-or-later AND LGPL-2.1-or-later AND LGPL-3.0-or-later) AND (GPL-3.0-or-later AND GFDL-1.3-only) AND (GPL-3.0-or-later AND GFDL-1.3-or-later AND BSD-4-Clause-UC AND MIT AND X11 AND LicenseRef-Fedora-Public-Domain) AND (GPL-3.0-or-later AND GPL-2.0-or-later AND GFDL-1.3-no-invariants-or-later) AND (GPL-3.0-or-later AND LGPL-2.1-or-later) AND (GPL-3.0-or-later AND LGPL-3.0-or-later AND (GPL-3.0-or-later WITH GCC-exception-3.1) AND (GPL-3.0-or-later WITH Texinfo-exception) AND (LGPL-2.1-or-later WITH GCC-exception-2.0) AND (GPL-2.0-or-later WITH GCC-exception-2.0) AND (GPL-2.0-or-later WITH GNU-compiler-exception) AND BSL-1.0 AND GFDL-1.3-or-later AND Linux-man-pages-copyleft-2-para AND SunPro AND BSD-1-Clause AND BSD-2-Clause AND BSD-2-Clause-Views AND BSD-3-Clause AND BSD-4-Clause AND BSD-Source-Code AND Zlib AND MIT AND Apache-2.0 AND (Apache-2.0 WITH LLVM-Exception) AND ZPL-2.1 AND ISC AND LicenseRef-Fedora-Public-Domain AND HP-1986 AND curl AND Martin-Birgmeier AND HPND-Markus-Kuhn AND dtoa AND SMLNJ AND AMD-newlib AND OAR AND HPND-merchantability-variant AND HPND-Intel) AND (GPL-3.0-or-later AND LGPL-3.0-or-later AND LGPL-2.1-or-later AND GPL-2.0-or-later AND LGPL-2.0-or-later AND GFDL-1.3-no-invariants-or-later) AND (GPL-3.0-or-later AND LGPL-3.0-or-later) AND (GPL-3.0-or-later AND MIT AND Unicode-DFS-2016 AND (0BSD OR MIT OR Apache-2.0) AND (Apache-2.0 OR MIT) AND (BSD-2-Clause OR Apache-2.0 OR MIT) AND (MIT OR Zlib OR Apache-2.0) AND (Unlicense OR MIT)) AND (HPND AND HPND-sell-variant AND X11 AND X11-distribute-modifications-variant AND MIT AND MIT-open-group AND xkeyboard-config-Zinoviev) AND (HPND AND LicenseRef-Fedora-Public-Domain AND Unicode-DFS-2016) AND (HPND AND MIT) AND (ISC AND BSD-2-Clause AND BSD-3-Clause AND BSD-4-Clause-UC) AND (ISC AND BSD-4-Clause AND BSD-2-Clause AND pkgconf AND MIT) AND (LGPL-2.0-or-later AND Apache-2.0 AND BSL-1.0 AND MIT AND Unicode-DFS-2016 AND (Apache-2.0 OR MIT) AND (MIT OR Apache-2.0 OR Zlib) AND (Unlicense OR MIT)) AND (LGPL-2.0-or-later AND BSD-3-Clause AND GPL-2.0-or-later AND Apache-2.0 AND (LGPL-2.0-or-later AND BSD-3-Clause) AND (MIT AND fmt-exception) AND NCL AND MIT AND LicenseRef-Fedora-Public-Domain) AND (LGPL-2.0-or-later AND LGPL-2.1-or-later) AND (LGPL-2.1-only OR MPL-1.1) AND (LGPL-2.1-or-later AND (BSD-3-Clause OR LGPL-2.1-or-later) AND FSFULLR AND GPL-2.0-or-later) AND (LGPL-2.1-or-later AND BSD-3-Clause AND BSD-2-Clause AND BSD-2-Clause-FreeBSD AND 0BSD AND CC0-1.0 AND LicenseRef-Fedora-Public-Domain) AND (LGPL-2.1-or-later AND GPL-2.0-or-later AND BSD-3-Clause) AND (LGPL-2.1-or-later AND GPL-2.0-or-later AND IJG-short AND BSD-2-Clause) AND (LGPL-2.1-or-later AND LGPL-2.0-or-later AND BSD-2-Clause-Views AND MIT) AND (LGPL-2.1-or-later AND LGPL-2.1-only AND BSD-2-Clause) AND (LGPL-2.1-or-later AND MIT AND GPL-2.0-or-later) AND (LGPL-2.1-or-later AND MIT) AND (LGPL-2.1-or-later AND SunPro AND LGPL-2.1-or-later WITH GCC-exception-2.0 AND BSD-3-Clause AND GPL-2.0-or-later AND LGPL-2.1-or-later WITH GNU-compiler-exception AND GPL-2.0-only AND ISC AND LicenseRef-Fedora-Public-Domain AND HPND AND CMU-Mach AND LGPL-2.0-or-later AND Unicode-3.0 AND GFDL-1.1-or-later AND GPL-1.0-or-later AND FSFUL AND MIT AND Inner-Net-2.0 AND X11 AND GPL-2.0-or-later WITH GCC-exception-2.0 AND GFDL-1.3-only AND GFDL-1.1-only) AND (LGPL-2.1-or-later AND Unicode-DFS-2016) AND (LGPL-2.1-or-later OR MPL-2.0 OR GPL-2.0-or-later) AND (LGPL-3.0-only OR CC-BY-SA-3.0) AND (LGPL-3.0-or-later OR GPL-2.0-or-later) AND (LicenseRef-BSD-3-Clause-Clear-WITH-AdditionRef-AOMPL-1.0 AND MIT AND ISC AND LicenseRef-Fedora-Public-Domain AND BSD-2-Clause) AND (LicenseRef-Callaway-BSD AND LicenseRef-Callaway-MIT) AND (LicenseRef-Callaway-LGPLv2 AND LicenseRef-Callaway-MIT) AND (LicenseRef-Callaway-LGPLv2+ AND Zlib) AND (LicenseRef-Fedora-Public-Domain AND (GPL-2.0-only WITH ClassPath-exception-2.0)) AND (LicenseRef-Fedora-Public-Domain AND ZPL-2.1) AND (MIT AND BSD-3-Clause AND SGI-B-2.0) AND (MIT AND CC-PDDC AND (GPL-3.0-or-later WITH Texinfo-exception)) AND (MIT AND GPL-2.0-or-later) AND (MIT AND GPL-3.0-or-later) AND (MIT AND HPND-sell-variant AND ICU) AND (MIT AND HPND-sell-variant AND SMLNJ AND MIT-open-group AND X11) AND (MIT AND HPND-sell-variant) AND (MIT AND ISC-Veillard AND W3C) AND (MIT AND LicenseRef-Fedora-Public-Domain) AND (MIT AND MIT-open-group AND X11) AND (MIT AND MIT-open-group) AND (MIT AND PSF-2.0 AND GPL-2.0-or-later) AND (MIT AND Python-2.0.1 AND Apache-2.0 AND BSD-2-Clause AND BSD-3-Clause AND ISC AND MPL-2.0 AND (Apache-2.0 OR BSD-2-Clause)) AND (MIT AND X11 AND HPND AND CC-BY-4.0) AND (MIT AND X11 AND MIT-CMU) AND (MIT AND X11) AND (MIT AND X11-distribute-modifications-variant) AND (MIT-feh AND MIT-Modern-Variant AND BSD-1-Clause AND BSD-3-Clause AND GPL-3.0-or-later WITH Autoconf-exception-macro) AND (MIT-open-group AND HPND-sell-variant AND X11 AND HPND-doc AND HPND-doc-sell) AND (MIT-open-group AND SMLNJ AND MIT) AND (MIT-open-group AND SMLNJ AND X11 AND ISC) AND (MIT-open-group AND X11 AND HPND AND HPND-sell-variant AND SMLNJ AND MIT AND ISC AND HPND-doc AND HPND-doc-sell) AND (MIT-open-group AND X11 AND HPND AND HPND-sell-variant AND SMLNJ AND NTP) AND (MPLv1.1 or GPLv2+ or LGPLv2+) AND (Python-2.0.1 AND CC0-1.0 AND MIT) AND (SISSL AND BSD-3-Clause) AND (SMLNJ AND HPND-sell-variant) AND (Unicode-DFS-2016 AND BSD-2-Clause AND BSD-3-Clause AND NAIST-2003 AND LicenseRef-Fedora-Public-Domain) AND (X11-distribute-modifications-variant AND HPND-sell-variant) AND (Zlib AND (LicenseRef-Callaway-Public-Domain OR MIT-0) AND LicenseRef-Callaway-MIT) AND (Zlib AND BSD-3-Clause AND MIT AND IJG) AND (Zlib AND LGPL-2.1-or-later AND ( MIT OR Unlicense ) AND LicenseRef-Fedora-Public-Domain) AND (Zlib AND MIT AND Apache-2.0 AND (Apache-2.0 OR MIT)) AND (Zlib and Apache-2.0 and MIT and BSD-3-Clause) AND 0BSD AND Apache-2.0 AND Artistic-2.0 AND BSD-2-Clause AND BSD-2-Clause-Patent AND BSD-3-Clause AND BSD-4-Clause AND BSD-Attribution-HPND-disclaimer AND CC0-1.0 AND FSFAP AND GD AND GPL-1.0-or-later AND GPL-2.0-only AND GPL-2.0-or-later AND GPL-3.0-only AND GPL-3.0-or-later AND HPND-sell-variant AND Info-ZIP AND LGPL-2.0-or-later AND LGPL-2.1-only AND LGPL-2.1-or-later AND LGPL-3.0-or-later AND LGPLv2+ AND LicenseRef-Callaway-LGPLv2 AND LicenseRef-Callaway-LGPLv2+ AND LicenseRef-Fedora-Public-Domain AND LicenseRef-Liberation AND MIT AND MIT-Modern-Variant AND MIT-open-group AND MPL-2.0 AND NCSA AND OFL-1.1 AND OFL-1.1-RFN AND OLDAP-2.8 AND Python-2.0.1 AND TTWL AND X11 AND X11-distribute-modifications-variant AND Zlib AND blessing AND curl AND libtiff AND tu-berlin-2.0 AND zlib

URL:            https://pagure.io/fedora-kiwi-descriptions
Source0:        %{baseurl}/Fedora-FEX-RootFS-%{image_version}-%{image_release}.x86_64.erofs.xz
Source1:        %{baseurl}/Fedora-FEX-RootFS-%{image_version}-%{image_release}.x86_64.erofs.xz.sha256
Source2:        %{baseurl}/Fedora-FEX-RootFS-%{image_version}-%{image_release}.x86_64.packages
Source3:        gen-license-tag.py

BuildRequires:  coreutils
BuildRequires:  xz
Requires:       fex-emu-filesystem
Provides:       fex-emu-rootfs(fedora) = %{version}-%{release}

BuildArch:      noarch

%description
This package provides a RootFS based on Fedora Linux to be used by the FEX
emulator.

%prep
%autosetup -p1 -c
ln -s %SOURCE0 .
sha256sum -c %SOURCE1

cp -p %SOURCE2 .
unxz -c %SOURCE0 > default.erofs

%build
# Nothing to build

%install
install -Dpm0644 default.erofs %{buildroot}%{_datadir}/fex-emu/RootFS/default.erofs

%files
%license Fedora-FEX-RootFS-%{image_version}-%{image_release}.x86_64.packages
%{_datadir}/fex-emu/RootFS/default.erofs

%changelog
%autochangelog
